print(j)
preds(res2)[j,3]
if(preds(res2)[j,3] ==k){
print(preds(res2)[j,3])
right = right + 1
print(paste("Number_right=",right,sep=""))
}
if(preds(res2)[j,3] !=k){
print(preds(res2)[j,3])
wrong = wrong + 1
print(paste("Number_wrong=",wrong,sep=""))
}
}
}
right <- 0
wrong <- 0
for(k in 1:81){
data <- image_tester(pathname,paste("Test",class_names[k],sep="/"))
res2 <- model_my_own %>% predict(data)
print(k)
print(preds(res2)[,3])
for(j in 1:length(preds(res2)[,1])){
#print(j)
#preds(res2)[j,3]
if(preds(res2)[j,3] ==k){
#print(preds(res2)[j,3])
right = right + 1
print(paste("Number_right=",right,sep=""))
}
if(preds(res2)[j,3] !=k){
#print(preds(res2)[j,3])
wrong = wrong + 1
print(paste("Number_wrong=",wrong,sep=""))
}
}
}
vec<-c(1,1,1,1)
sum(vec == 0)
sum(vec == 1)
rep(k)
rep(k,100)
preds(res2)[,3]-rep(k,length(preds(res2)[,3]))
right <- 0
wrong <- 0
for(k in 1:81){
data <- image_tester(pathname,paste("Test",class_names[k],sep="/"))
res2 <- model_my_own %>% predict(data)
print(k)
print(preds(res2)[,3])
vec<-preds(res2)[,3]-rep(k,length(preds(res2)[,3]))
right<-right+sum(vec==0)
wrong<-wrong+(length(preds(res2)[,3]) - sum(vec==0))
}
right <- 0
wrong <- 0
for(k in 1:81){
data <- image_tester(pathname,paste("Test",class_names[k],sep="/"))
res2 <- model_my_own %>% predict(data)
print(k)
print(preds(res2)[,3])
vec<-preds(res2)[,3]-rep(k,length(preds(res2)[,3]))
right<-right+sum(vec==0)
wrong<-wrong+(length(preds(res2)[,3]) - sum(vec==0))
print(paste("Number right =",right))
print(paste("Number wrong =",wrong))
}
class_names
class_names[1]
image_tester(pathname,"Test/Apple_Braeburn")
dim(image_tester(pathname,"Test/Apple_Braeburn"))
results <- model_my_own %>% predict(Test_data_reshaped[,,,channel_no,drop = F])
results
results[,1]
results[1,]
data <- image_tester(pathname,paste("Test",class_names[k],sep="/"))
res2 <- model_my_own %>% predict(data)
res2
res2[,1]
res2[1,]
dim(res2)
right <- 0
wrong <- 0
for(k in 1:81){
data <- image_tester(pathname,paste("Test",class_names[k],sep="/"))
res2 <- model_my_own %>% predict(data)
print(k)
print(preds(res2)[,3])
vec<-preds(res2)[,3]-rep(k,length(preds(res2)[,3]))
right<-right+sum(vec==0)
wrong<-wrong+(length(preds(res2)[,3]) - sum(vec==0))
print(paste("Number right =",right))
print(paste("Number wrong =",wrong))
}
right <- 0
wrong <- 0
for(k in 1:81){
data <- image_tester(pathname,paste("Test",class_names[k],sep="/"))
res2 <- model_my_own %>% predict(data)
print(class_names(k))
print(class_names(preds(res2)[,3]))
vec<-preds(res2)[,3]-rep(k,length(preds(res2)[,3]))
right<-right+sum(vec==0)
wrong<-wrong+(length(preds(res2)[,3]) - sum(vec==0))
print(paste("Number right =",right))
print(paste("Number wrong =",wrong))
}
right <- 0
wrong <- 0
for(k in 1:81){
data <- image_tester(pathname,paste("Test",class_names[k],sep="/"))
res2 <- model_my_own %>% predict(data)
print(class_names[k])
print(class_names[preds(res2)[,3]])
vec<-preds(res2)[,3]-rep(k,length(preds(res2)[,3]))
right<-right+sum(vec==0)
wrong<-wrong+(length(preds(res2)[,3]) - sum(vec==0))
print(paste("Number right =",right))
print(paste("Number wrong =",wrong))
}
results <- model_my_own %>% predict(Test_data_reshaped[,,,channel_no,drop = F])
results
which.max(results)
which.max(results[,1])
which.max(results[1,])
which.max(results[2,])
which.max(results[3,])
which.max(results[4,])
which.max(results[5,])
which.max(results[6,])
results <- model_my_own %>% evaluate(Test_data_reshaped[,,,channel_no,drop=F], Test_labels)
results
82*82
right <- 0
wrong <- 0
for(k in 1:81){
data <- image_tester(pathname,paste("Test",class_names[k],sep="/"))
res2 <- model_my_own %>% predict(data)
print(k)
print(preds(res2)[,3])
vec<-preds(res2)[,3]-rep(k,length(preds(res2)[,3]))
right<-right+sum(vec==0)
wrong<-wrong+(length(preds(res2)[,3]) - sum(vec==0))
print(paste("Number right =",right))
print(paste("Number wrong =",wrong))
}
right <- 0
wrong <- 0
for(k in 1:81){
data <- image_tester(pathname,paste("Test",class_names[k],sep="/"))
res2 <- model_my_own %>% predict(data)
print(k)
print(preds(res2)[,3])
vec<-preds(res2)[,3]-rep(k,length(preds(res2)[,3]))
right<-right+sum(vec==0)
wrong<-wrong+(length(preds(res2)[,3]) - sum(vec==0))
print(paste("Number right =",right,", Number wrong =",wrong))
}
class_names[81]
class_names[82]
length(class_names)
right <- 0
wrong <- 0
for(k in 1:length(class_names)){
data <- image_tester(pathname,paste("Test",class_names[k],sep="/"))
res2 <- model_my_own %>% predict(data)
print(k)
print(preds(res2)[,3])
vec<-preds(res2)[,3]-rep(k,length(preds(res2)[,3]))
right<-right+sum(vec==0)
wrong<-wrong+(length(preds(res2)[,3]) - sum(vec==0))
print(paste("Number right =",right,", Number wrong =",wrong,", Accuracy =",right/(wrong+right)))
}
Test_labels
Test_data_reshaped
dim(Test_data_reshaped)
length(Test_labels)
right <- 0
wrong <- 0
for(k in 20:40){ #1:length(class_names))
data <- image_tester(pathname,paste("Test",class_names[k],sep="/"))
res2 <- model_my_own %>% predict(data)
print(k)
print(preds(res2)[,3])
vec<-preds(res2)[,3]-rep(k,length(preds(res2)[,3]))
right<-right+sum(vec==0)
wrong<-wrong+(length(preds(res2)[,3]) - sum(vec==0))
print(paste("Number right =",right,", Number wrong =",wrong,", Accuracy =",right/(wrong+right),sep=''))
}
results <- model_my_own %>% evaluate(Test_data_reshaped[,,,channel_no,drop=F], Test_labels)
results
right <- 0
wrong <- 0
for(k in 41){ #1:length(class_names))
data <- image_tester(pathname,paste("Test",class_names[k],sep="/"))
res2 <- model_my_own %>% predict(data)
print(k)
print(preds(res2)[,3])
vec<-preds(res2)[,3]-rep(k,length(preds(res2)[,3]))
right<-right+sum(vec==0)
wrong<-wrong+(length(preds(res2)[,3]) - sum(vec==0))
print(paste("Number right =",right,", Number wrong =",wrong,", Accuracy =",right/(wrong+right),sep=''))
}
right <- 0
wrong <- 0
for(k in 19){ #1:length(class_names))
data <- image_tester(pathname,paste("Test",class_names[k],sep="/"))
res2 <- model_my_own %>% predict(data)
print(k)
print(preds(res2)[,3])
vec<-preds(res2)[,3]-rep(k,length(preds(res2)[,3]))
right<-right+sum(vec==0)
wrong<-wrong+(length(preds(res2)[,3]) - sum(vec==0))
print(paste("Number right =",right,", Number wrong =",wrong,", Accuracy =",right/(wrong+right),sep=''))
}
right <- 0
wrong <- 0
for(k in 20:40){
data <- image_tester(pathname,paste("Test",class_names[k],sep="/"))
res2 <- model_my_own %>% predict(data)
print(k)
print(preds(res2)[,3])
vec<-preds(res2)[,3]-rep(k,length(preds(res2)[,3]))
right<-right+sum(vec==0)
wrong<-wrong+(length(preds(res2)[,3]) - sum(vec==0))
print(paste("Number right =",right,", Number wrong =",wrong,", Accuracy =",right/(wrong+right),sep=''))
}
3360+262
# manually test accuracy. This gives 3360/3622 NOT 3386/3622. Why?
right <- 0
wrong <- 0
for(k in 20:40){
data <- image_tester(pathname,paste("Test",class_names[k],sep="/"))
res2 <- model_my_own %>% predict(data)
print(k)
print(preds(res2)[,3])
vec<-preds(res2)[,3]-rep(k,length(preds(res2)[,3]))
right<-right+sum(vec==0)
wrong<-wrong+(length(preds(res2)[,3]) - sum(vec==0))
print(paste("Number right =",right,", Number wrong =",wrong,", Accuracy =",right/(wrong+right),sep=''))
}
results <- model_my_own %>% evaluate(Test_data_reshaped[1:164,,,channel_no,drop=F], Test_labels)
results
results <- model_my_own %>% evaluate(Test_data_reshaped[1:164,,,channel_no,drop=F], Test_labels[1:164])
results
results <- model_my_own %>% evaluate(Test_data_reshaped[165:3622,,,channel_no,drop=F], Test_labels[165:3622])
results
(3360-131)/(3622-164)
3622-164
Test_labels[164]
Test_labels[165]
0.9337767*164
153/164
154/164
0.8231707*164
results <- model_my_own %>% predict(Test_data_reshaped[1:164,,,channel_no,drop = F]) # drop = F stops R collapsing array to 3 dimensions not 4
results
results[1,]
results <- model_my_own %>% predict_classes(Test_data_reshaped[1:164,,,channel_no,drop = F]) # drop = F stops R collapsing array to 3 dimensions not 4
results
k=20
data <- image_tester(pathname,paste("Test",class_names[k],sep="/"))
res2 <- model_my_own %>% predict(data)
print(k)
print(preds(res2)[,3])
resultz<-preds(res2)[,3]
resultz-results
which.max(resultz-results)
install.packages("rmarkdown")
render("markdown.Rmd")
library(markdown)
render("markdown.Rmd")
render("markdown.Rmd",ouput_file = "report.html")
knitr::opts_chunk$set(echo = TRUE)
source('~/GitHub/NIAB_Rotation/Fruit_model/Data/Data_Functions.R')# contains functions 'folder_names', 'labeller', 'Data_in_final_form'
source('~/GitHub/NIAB_Rotation/Fruit_model/Data/Data_Functions.R')# contains functions 'folder_names', 'labeller', 'Data_in_final_form'
source('~/GitHub/NIAB_Rotation/Fruit_model/Run/Parameters.R')     # needs Data_Functions
source('~/GitHub/NIAB_Rotation/Fruit_model/Data/Data_Functions.R')# contains functions 'folder_names', 'labeller', 'Data_in_final_form'
source('~/GitHub/NIAB_Rotation/Fruit_model/Data/Data_Producer.R')
? array_reshape
? params
? param
install(params)
install.packages(params)
install.packages("params")
?params
library(params)
?params
model_name <- "fruit_model_new.h5" # "fruit_model.h5"
model_my_own <-create_fruit_model(Train_data_reshaped[,,,params$channel_no,drop = F],Train_labels,Test_data_reshaped[,,,params$channel_no,drop = F],Test_labels,params$channels) # drop = F stops R collapsing array to 3 dimensions not 4
render('markdown.Rmd',params= list( channels = 1, channel_no = 1, xshape=10, yshape=10,labels_to_be_tested = c(17,39)))
require(markdown)
render('markdown.Rmd',params= list( channels = 1, channel_no = 1, xshape=10, yshape=10,labels_to_be_tested = c(17,39)))
require(rmarkdown)
render('markdown.Rmd',params= list( channels = 1, channel_no = 1, xshape=10, yshape=10,labels_to_be_tested = c(17,39)))
render('markdown.Rmd',ouput_file = "report.html",params= list( channels = 1, channel_no = 1, xshape=10, yshape=10,labels_to_be_tested = c(17,39)))
render('markdown.Rmd',output_file = "report.html",params= list( channels = 1, channel_no = 1, xshape=10, yshape=10,labels_to_be_tested = c(17,39)))
render('source('~/GitHub/NIAB_Rotation/Fruit_model/Run/markdown.Rmd',output_file = "report.html",params= list( channels = 1, channel_no = 1, xshape=10, yshape=10,labels_to_be_tested = c(17,39)))
render(~/GitHub/NIAB_Rotation/Fruit_model/Run/markdown.Rmd',output_file = "report.html",params= list( channels = 1, channel_no = 1, xshape=10, yshape=10,labels_to_be_tested = c(17,39)))
render('~/GitHub/NIAB_Rotation/Fruit_model/Run/markdown.Rmd',output_file = "report.html",params= list( channels = 1, channel_no = 1, xshape=10, yshape=10,labels_to_be_tested = c(17,39)))
report.html
open report.html
results
results2
results3 <- model_my_own %>% evaluate(Test_data_reshaped[,,,params$channel_no,drop=F], Test_labels)
results3
as.data.frame(results3)
frame<-as.data.frame(results3)
frame$Model <- c("R only")
frame
frame<-rbind(frame,as.data.frame(results2),as.data.frame(results3))
frame<-rbind(frame,as.data.frame(results),as.data.frame(results))
frame<-as.data.frame(results3)
frame<-rbind(frame,as.data.frame(results),as.data.frame(results))
frame<-rbind(frame,as.data.frame(results3),as.data.frame(results3))
frame
frame<-as.data.frame(results)
frame<-rbind(frame,as.data.frame(results2),as.data.frame(results3))
results2 <- model_my_own %>% evaluate(Test_data_reshaped[,,,params$channel_no,drop=F], Test_labels)
results <- model_my_own %>% evaluate(Test_data_reshaped[,,,params$channel_no,drop=F], Test_labels)
results3 <- model_my_own %>% evaluate(Test_data_reshaped[,,,params$channel_no,drop=F], Test_labels)
frame<-as.data.frame(results)
frame<-rbind(frame,as.data.frame(results2),as.data.frame(results3))
frame$Model<-c("R only","G only","B only")
frame <- aperm(frame,c(3,1,2))
frame<-as.data.frame(results)
colnames(frame)<-c("Loss","Accuracy")
frame<-rbind(frame,as.data.frame(results2),as.data.frame(results3))
frame<-as.data.frame(results)
frame<-rbind(frame,as.data.frame(results2),as.data.frame(results3))
colnames(frame)<-c("Loss","Accuracy")
frame$Model<-c("R only","G only","B only")
frame<-frame[c("Model","Loss","Accuracy")]
frame
knitr::kable(frame, caption = "Summary")
?params::check_args
source('~/GitHub/NIAB_Rotation/Fruit_model/Run/Parameters.R')
install.packages("config")
source('~/GitHub/NIAB_Rotation/Fruit_model/Run/config.yml')
config <- config::get()
cd
source('~/GitHub/NIAB_Rotation/Fruit_model/config.yml')
View(params)
config <- config::get()
getwd()
setwd(NIAB_Rotation)
setwd('~/GitHub/NIAB_Rotation')
getwd()
config <- config::get()
setwd('~/GitHub/NIAB_Rotation/Fruit_model')
config <- config::get()
config <- config::get()
config <- config::get()
config
config <- config::get(default)
config <- config::get(xshape)
config <- config::get("xshape")
config
#Sys.setenv(R_CONFIG_ACTIVE = "default_RGB")
config <- config::get()
#Sys.setenv(R_CONFIG_ACTIVE = "default")
config <- config::get()
config
config$channels<-3
config$channels
config$channels<-2
config$channels
config<-get_config()
config <- config::get()
xshape
config$xshape
source('~/GitHub/NIAB_Rotation/Fruit_model/Data/Data_Functions.R')# contains functions 'folder_names', 'labeller', 'Data_in_final_form'
# source('~/GitHub/NIAB_Rotation/Fruit_model/Run/Parameters.R')     # needs Data_Functions
source('~/GitHub/NIAB_Rotation/Fruit_model/Analysis/Functions.R') # contains functions 'image_tester', 'preds', 'multipreds', 'image_predictor'
source('~/GitHub/NIAB_Rotation/Fruit_model/Data/Data_Producer.R') # slow to run
source('~/GitHub/NIAB_Rotation/Fruit_model/Model/Fruit_model.R')  # needs parameters   # contains function 'create_fruit_model', 'image_predictor'
library(keras)
library(dplyr)
library(ggplot2)
library(tidyr)
# data comes in from Data_Producer
############################################
# fit model
model_name <- "fruit_model_new.h5" # "fruit_model.h5"
model_my_own <-create_fruit_model(Train_data_reshaped[,,,config$channel_no,drop = F],Train_labels,Test_data_reshaped[,,,config$channel_no,drop = F],Test_labels,config$channels) # drop = F stops R collapsing array to 3 dimensions not 4
model_my_own %>% summary()
model_my_own %>% save_model_hdf5(model_name)
# below model has all fruits
#new_model <- load_model_hdf5("fruit_model.h5")
#new_model %>% summary()
results <- model_my_own %>% evaluate(Test_data_reshaped[,,,config$channel_no,drop=F], Test_labels)
results
results <- model_my_own %>% predict_classes(Test_data_reshaped[,,,config$channel_no,drop = F]) # drop = F stops R collapsing array to 3 dimensions not 4
############################################
data <- image_tester(config$internet_path,"Walnut")
res2 <- model_my_own %>% predict(data)
preds(res2)
multipreds(res2,config$number_probs)
source('~/GitHub/NIAB_Rotation/Fruit_model/Data/Data_Functions.R')# contains functions 'folder_names', 'labeller', 'Data_in_final_form'
# source('~/GitHub/NIAB_Rotation/Fruit_model/Run/Parameters.R')     # needs Data_Functions
#Sys.setenv(R_CONFIG_ACTIVE = "default")
config <- config::get()
source('~/GitHub/NIAB_Rotation/Fruit_model/Analysis/Functions.R') # contains functions 'image_tester', 'preds', 'multipreds', 'image_predictor'
source('~/GitHub/NIAB_Rotation/Fruit_model/Data/Data_Producer.R') # slow to run
source('~/GitHub/NIAB_Rotation/Fruit_model/Model/Fruit_model.R')  # needs parameters   # contains function 'create_fruit_model', 'image_predictor'
library(keras)
library(dplyr)
library(ggplot2)
library(tidyr)
# data comes in from Data_Producer
############################################
# fit model
model_name <- "fruit_model_new.h5" # "fruit_model.h5"
model_my_own <-create_fruit_model(Train_data_reshaped[,,,config$channel_no,drop = F],Train_labels,Test_data_reshaped[,,,config$channel_no,drop = F],Test_labels,config$channels) # drop = F stops R collapsing array to 3 dimensions not 4
model_my_own %>% summary()
model_my_own %>% save_model_hdf5(model_name)
# below model has all fruits
#new_model <- load_model_hdf5("fruit_model.h5")
#new_model %>% summary()
results <- model_my_own %>% evaluate(Test_data_reshaped[,,,config$channel_no,drop=F], Test_labels)
results
results <- model_my_own %>% predict_classes(Test_data_reshaped[,,,config$channel_no,drop = F]) # drop = F stops R collapsing array to 3 dimensions not 4
############################################
data <- image_tester(config$internet_path,"Walnut")
res2 <- model_my_own %>% predict(data)
preds(res2)
multipreds(res2,config$number_probs)
source('~/GitHub/NIAB_Rotation/Fruit_model/Data/Data_Functions.R')# contains functions 'folder_names', 'labeller', 'Data_in_final_form'
# source('~/GitHub/NIAB_Rotation/Fruit_model/Run/Parameters.R')     # needs Data_Functions
#Sys.setenv(R_CONFIG_ACTIVE = "default")
config <- config::get()
source('~/GitHub/NIAB_Rotation/Fruit_model/Analysis/Functions.R') # contains functions 'image_tester', 'preds', 'multipreds', 'image_predictor'
source('~/GitHub/NIAB_Rotation/Fruit_model/Data/Data_Producer.R') # slow to run
source('~/GitHub/NIAB_Rotation/Fruit_model/Data/Data_Functions.R')# contains functions 'folder_names', 'labeller', 'Data_in_final_form'
# source('~/GitHub/NIAB_Rotation/Fruit_model/Run/Parameters.R')     # needs Data_Functions
#Sys.setenv(R_CONFIG_ACTIVE = "default")
config <- config::get()
source('~/GitHub/NIAB_Rotation/Fruit_model/Analysis/Functions.R') # contains functions 'image_tester', 'preds', 'multipreds', 'image_predictor'
source('~/GitHub/NIAB_Rotation/Fruit_model/Data/Data_Producer.R') # slow to run
source('~/GitHub/NIAB_Rotation/Fruit_model/Model/Fruit_model.R')  # needs parameters   # contains function 'create_fruit_model', 'image_predictor'
library(keras)
library(dplyr)
library(ggplot2)
library(tidyr)
# data comes in from Data_Producer
############################################
# fit model
model_name <- "fruit_model_new.h5" # "fruit_model.h5"
model_my_own <-create_fruit_model(Train_data_reshaped[,,,config$channel_no,drop = F],Train_labels,Test_data_reshaped[,,,config$channel_no,drop = F],Test_labels,config$channels) # drop = F stops R collapsing array to 3 dimensions not 4
model_my_own %>% summary()
model_my_own %>% save_model_hdf5(model_name)
# below model has all fruits
#new_model <- load_model_hdf5("fruit_model.h5")
#new_model %>% summary()
results <- model_my_own %>% evaluate(Test_data_reshaped[,,,config$channel_no,drop=F], Test_labels)
results
results <- model_my_own %>% predict_classes(Test_data_reshaped[,,,config$channel_no,drop = F]) # drop = F stops R collapsing array to 3 dimensions not 4
############################################
data <- image_tester(config$internet_path,"Walnut")
res2 <- model_my_own %>% predict(data)
preds(res2)
multipreds(res2,config$number_probs)
config$pathname
config$training_folder
config$class_names
config$labels_to_be_tested
config$filetype
Train_data_and_labels <- Data_in_final_form(config$pathname,config$training_folder,config$class_names,config$labels_to_be_tested,config$filetype)
config$pathname
config$labels_to_be_tested
config
config$class_names
config$channel_no
as.numeric(config$channel_no)
config$class_names_frame
? config
?options
source('~/GitHub/NIAB_Rotation/Fruit_model/Run/params.R')
params$pathname
source('~/GitHub/NIAB_Rotation/Fruit_model/Run/params.R')
params$pathname
params$channel_no
params$channels
source('~/GitHub/NIAB_Rotation/Fruit_model/Data/Data_Functions.R')# contains functions 'folder_names', 'labeller', 'Data_in_final_form'
# source('~/GitHub/NIAB_Rotation/Fruit_model/Run/Parameters.R')     # needs Data_Functions
source('~/GitHub/NIAB_Rotation/Fruit_model/Run/Params.R')     # needs Data_Functions
# Sys.setenv(R_CONFIG_ACTIVE = "default")
# config <- config::get()
source('~/GitHub/NIAB_Rotation/Fruit_model/Analysis/Functions.R') # contains functions 'image_tester', 'preds', 'multipreds', 'image_predictor'
source('~/GitHub/NIAB_Rotation/Fruit_model/Data/Data_Producer.R') # slow to run
source('~/GitHub/NIAB_Rotation/Fruit_model/Model/Fruit_model.R')  # needs parameters   # contains function 'create_fruit_model', 'image_predictor'
library(keras)
library(dplyr)
library(ggplot2)
library(tidyr)
# data comes in from Data_Producer
############################################
# fit model
model_name <- "fruit_model_new.h5" # "fruit_model.h5"
model_my_own <-create_fruit_model(Train_data_reshaped[,,,params$channel_no,drop = F],Train_labels,Test_data_reshaped[,,,params$channel_no,drop = F],Test_labels,params$channels) # drop = F stops R collapsing array to 3 dimensions not 4
model_my_own %>% summary()
model_my_own %>% save_model_hdf5(model_name)
# below model has all fruits
#new_model <- load_model_hdf5("fruit_model.h5")
#new_model %>% summary()
results <- model_my_own %>% evaluate(Test_data_reshaped[,,,params$channel_no,drop=F], Test_labels)
results
results <- model_my_own %>% predict_classes(Test_data_reshaped[,,,params$channel_no,drop = F]) # drop = F stops R collapsing array to 3 dimensions not 4
############################################
data <- image_tester(params$internet_path,"Walnut")
res2 <- model_my_own %>% predict(data)
preds(res2)
multipreds(res2,params$number_probs)
